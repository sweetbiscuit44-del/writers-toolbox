<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Writer‚Äôs Tool Box ‚úçÔ∏è</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    /* ‚≠ê MODERNIZED VARIABLES */
    :root {
      --primary: #4a4e69; /* Deep Blue/Grey for text */
      --accent: #9d8189; /* Rose/Dusty Pink Accent */
      --bg-main: #f5f5f7; /* Very light subtle background */
      --bg-tool: #ffffff; /* White card background */
      --bg-result: #f0f4f7; /* Light result background */
      --shadow-light: 0 1px 3px rgba(0,0,0,0.05), 0 5px 15px rgba(0,0,0,0.02);
      --shadow-accent: 0 4px 10px rgba(157, 129, 137, 0.2);
      --radius: 10px;
      /* Biscuit colors from your theme */
¬† ¬† ¬† --biscuit-primary: #d2691e;
    }
    
    * { box-sizing: border-box; }

    body {
      font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 30px 16px;
      background: var(--bg-main);
      color: var(--primary);
      line-height: 1.5;
    }

    /* FLOATING BISCUIT ICON */
¬† ¬† .biscuit-icon {
¬† ¬† ¬† font-size: 3.5rem;
¬† ¬† ¬† color: var(--biscuit-primary);
¬† ¬† ¬† margin: 0 auto 15px; 
¬† ¬† ¬† animation: biscuit-bounce 1.8s infinite alternate cubic-bezier(.27,.67,.33,.95);
¬† ¬† ¬† display: block;
¬† ¬† ¬† text-align: center;
¬† ¬† }
¬† ¬† @keyframes biscuit-bounce {
¬† ¬† ¬† to { transform: translateY(-10px) scale(1.05);}
¬† ¬† ¬† from { transform: translateY(0px) scale(1);}
¬† ¬† }

    h1 {
      text-align: center;
      color: var(--primary);
      font-size: 2.4em;
      margin: 0 0 30px;
    }
    
    h2 {
      font-size: 1.4em;
      margin-top: 0;
      color: var(--accent);
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .tool {
      background: var(--bg-tool);
      border-radius: var(--radius);
      padding: 25px;
      margin: 20px 0;
      box-shadow: var(--shadow-light);
      border: 1px solid #f0f0f0;
    }

    textarea, input {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    textarea:focus, input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(157, 129, 137, 0.15);
      outline: none;
    }
    textarea {
      min-height: 150px;
      font-family: inherit;
    }
    
    button {
      width: 100%;
      padding: 12px;
      margin: 15px 0 0;
      border: none;
      border-radius: 8px;
      background: var(--accent);
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      box-shadow: 0 4px 8px rgba(157, 129, 137, 0.3);
    }
    button:hover {
      background: #8b7379;
      transform: translateY(-1px);
    }
    button:active {
      transform: translateY(0);
    }

    .result {
      background: var(--bg-result);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      white-space: pre-wrap;
      font-size: 0.95em;
      color: #333;
      border-left: 5px solid var(--accent);
      font-family: monospace; /* Better for reading formatted results */
    }
    
    /* FOOTER AND PAYPAL */
    footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px dashed #ddd;
      color: #777;
      font-size: 0.9em;
    }
    .heart { color: #e74c3c; }
    
    .paypal-button a {
      display: inline-flex;
      align-items: center;
      padding: 10px 20px;
      background: #ffc439;
      color: #111;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      margin-top: 15px;
      transition: transform 0.1s, box-shadow 0.2s;
      gap: 8px;
    }
    .paypal-button a:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(255, 196, 57, 0.4);
    }
    .paypal-button img {
      display: none; /* Hide original image */
    }
  </style>
</head>
<body>
  <div class="biscuit-icon" aria-label="Cookie Icon">
    <i class="fas fa-cookie-bite" aria-hidden="true"></i>
  </div>
  
  <h1>Writer‚Äôs Tool Box ‚úçÔ∏è</h1>
  
  <div class="tool">
    <h2><i class="fas fa-pencil-alt"></i> 1. Focus Writer (Auto-Save)</h2>
    <textarea id="writer" placeholder="Start your masterpiece here. Type freely‚Äîauto-save works when allowed by your browser."></textarea>
    <div class="result" id="wordCount">Words: 0</div>
  </div>
  
  <div class="tool">
    <h2><i class="fas fa-graduation-cap"></i> 2. Readability Score</h2>
    <textarea id="readText" placeholder="Paste your draft to check Flesch-Kincaid reading ease and grade level"></textarea>
    <button onclick="checkReadability()"><i class="fas fa-chart-bar"></i> Analyze Readability</button>
    <div class="result" id="readResult">Result will appear here.</div>
  </div>
  
  <div class="tool">
    <h2><i class="fas fa-feather-alt"></i> 3. Haiku Inspiration (5-7-5)</h2>
    <button onclick="generateHaiku()">‚ú® Generate a Haiku</button>
    <div class="result" id="haikuResult">Your haiku will appear here.</div>
  </div>
  
  <div class="tool">
    <h2><i class="fas fa-smile"></i> 4. Tone & CAPS Fixer</h2>
    <textarea id="toneText" placeholder="Paste a message or email draft to soften tone and fix accidental ALL CAPS"></textarea>
    <button onclick="softenTone()"><i class="fas fa-hands-helping"></i> Soften Tone + Fix CAPS</button>
    <div class="result" id="toneResult">Revised text will appear here.</div>
  </div>
  
  <div class="tool">
    <h2><i class="fas fa-file-export"></i> 5. Export as .txt</h2>
    <button onclick="exportText()">üíæ Download Your Writing as .txt</button>
  </div>
  
  <footer>
    <p>Created with love by Sweet Biscuit44 <span class="heart">‚ù§Ô∏è</span><br>
    One HTML file. Zero tracking. All heart.</p>
    <p style="font-weight: 600; font-style: normal; margin-top: 10px; color: var(--primary);">
        üîó Visit my main website: <a href="https://sweetbiscuit44-del.github.io/sweet-biscuit44-home-page/" target="_blank" style="color: var(--accent); text-decoration: none;">SweetBiscuit44.com</a>
    </p>
    <div class="paypal-button">
      <a href="https://www.paypal.com/paypalme/sweetbiscuit44" target="_blank">
        <i class="fab fa-paypal"></i> Support Sweet Biscuit44
      </a>
    </div>
  </footer>
  
  <script>
    // ===== SAFE LOCALSTORAGE CHECK =====    
    let canUseStorage = false;    
    try {      
      const test = '__storage_test__';      
      localStorage.setItem(test, test);      
      localStorage.removeItem(test);      
      canUseStorage = true;    
    } catch(e) {      
      console.warn("localStorage unavailable (e.g., file:// mode). Auto-save disabled.");    
    }

    // ===== FOCUS WRITER =====    
    const writer = document.getElementById('writer');    
    const wordCountEl = document.getElementById('wordCount');

    if (canUseStorage && localStorage.getItem('writerText')) {      
      writer.value = localStorage.getItem('writerText');    
      // Initial count update after loading content
      const initialWords = writer.value.trim() ? writer.value.trim().split(/\s+/).length : 0;
      wordCountEl.textContent = `Words: ${initialWords} (auto-saved)`;
    }

    writer.addEventListener('input', () => {      
      if (canUseStorage) {        
        localStorage.setItem('writerText', writer.value);      
      }      
      const words = writer.value.trim() ? writer.value.trim().split(/\s+/).length : 0;      
      wordCountEl.textContent = canUseStorage         
         ? `Words: ${words} (auto-saved)`         
         : `Words: ${words} (auto-save disabled in file:// mode)`;    
    });

    // ===== READABILITY CHECKER (Flesch-Kincaid Grade Level) =====
    function checkReadability() {      
      const text = document.getElementById('readText').value;      
      if (!text.trim()) return document.getElementById('readResult').textContent = "Please enter text.";
      
      const words = text.trim().split(/\s+/).length;
      // Get sentences by splitting on punctuation followed by space/end (a common approximation)
      const sentences = text.split(/[.!?]+/).filter(s => s.trim()).length || 1;
      
      // Original formula from user's code (Flesch Reading Ease variation, scaled down)
      const score = 206.835 - 1.015 * (words / sentences) - 84.6;
      
      let grade = 'Not determinable';
      if (score > 90) grade = "5th grade (Very Easy)";
      else if (score > 80) grade = "6th grade";
      else if (score > 70) grade = "7th grade";
      else if (score > 60) grade = "8th‚Äì9th grade (Standard)";
      else if (score > 50) grade = "10th‚Äì12th grade";
      else if (score > 30) grade = "College";
      else grade = "College Graduate/Professional";

      document.getElementById('readResult').textContent =         
         `Score: ${Math.round(score)} (Higher is Easier)\nGrade Level: ${grade}\nWords: ${words}, Sentences: ${sentences}`;    
    }

    // ===== HAIKU GENERATOR =====    
    const lines5 = ["Morning sun rises", "Silent moon above", "Rain taps the window", "Leaves fall without sound", "Coffee steam curls up", "Soft breezes sigh low"];    
    const lines7 = ["A bird sings in the old oak tree", "Thoughts drift like clouds across the sky", "My cat watches birds with sharp eyes", "Words flow like rivers in my mind", "Night wraps the world in softest blue", "The keyboard clicks with every thought"];    
    
    function generateHaiku() {      
      const h1 = lines5[Math.floor(Math.random() * lines5.length)];      
      const h2 = lines7[Math.floor(Math.random() * lines7.length)];      
      const h3 = lines5[Math.floor(Math.random() * lines5.length)];      
      document.getElementById('haikuResult').textContent = `1. ${h1}\n2. ${h2}\n3. ${h3}`;    
    }
    
    // ===== SMART TONE + CAPS FIXER =====    
    function fixAccidentalCaps(text) {      
      const alphaChars = text.replace(/[^a-zA-Z]/g, '');      
      if (alphaChars.length < 4) return text; // Too short to analyze
      // Check if majority of characters are uppercase
      const upperRatio = (alphaChars.match(/[A-Z]/g) || []).length / alphaChars.length;      
      if (upperRatio < 0.8) return text; // If not mostly CAPS, leave it
      
      // Convert to lowercase and then capitalize the start of sentences
      return text        
        .toLowerCase()        
        .replace(/(\.|\!|\?|\n|^)(\s*)([a-z])/g, (match, p1, p2, p3) => p1 + p2 + p3.toUpperCase());
    }

    function softenToneIntelligently(text) {      
      let result = text;
      // Added more variations for common phrases
      result = result.replace(/\b(you should)\s+([a-z])/gi, "you might consider $2");
      result = result.replace(/\b(can't|cannot)\b/gi, "might not be able to");
      result = result.replace(/\b(this is wrong)\b/gi, "this might need a second look");
      result = result.replace(/\b(obviously|clearly|everyone knows)\b/gi, "it seems");
      result = result.replace(/\b(just do it|do this now|fix this)\b/gi, "could you please try?");
      result = result.replace(/\b(no way|never going to work|terrible idea)\b/gi, "that might be difficult");
      result = result.replace(/\b(you failed|you messed up|you forgot)\b/gi, "there might have been a hiccup with");
      result = result.replace(/\b(urgent|immediately)\b/gi, "as soon as possible");
      
      return result;    
    }
    
    function softenTone() {      
      let text = document.getElementById('toneText').value;      
      if (!text.trim()) return document.getElementById('toneResult').textContent = "Enter a message.";

      // 1. Fix Caps
      text = fixAccidentalCaps(text);
      
      // 2. Soften Tone
      let soft = softenToneIntelligently(text);

      // 3. Ensure sentence ending (if it looks like a full sentence)
      if (/[a-zA-Z]$/.test(soft.trim())) {        
        soft = soft.trim() + '.'; // Add period if it ends with a letter
      }
      
      document.getElementById('toneResult').textContent = soft;    
    }
    
    // ===== EXPORT AS .TXT =====    
    function exportText() {      
      const content = writer.value || "Your writing from the Focus Writer.";      
      const blob = new Blob([content], { type: 'text/plain' });      
      const url = URL.createObjectURL(blob);      
      const a = document.createElement('a');      
      a.href = url;      
      a.download = 'my-writing.txt';      
      document.body.appendChild(a);      
      a.click();      
      document.body.removeChild(a);      
      URL.revokeObjectURL(url);    
    }  
  </script>
</body>
</html>
